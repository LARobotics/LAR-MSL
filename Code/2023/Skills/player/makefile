#############################################################################
# Makefile for building: Robo
# Generated by qmake (2.01a) (Qt 4.7.0) on: Mon Jun 13 16:32:50 2011
# Project:  
# Template: app

#############################################################################

####### Compiler, tools and options   go run . ttyUSB0 0

#IP := $(sh ~/networkScrip.sh)

IP := $(shell ~/networkScript.sh)

BS := "172.16.49.156"
ID:=4
ifeq ($B,1)
    BS = "172.16.49.136"
endif


all:
	@echo 0,0,0,0,0,0 > /dev/ttyUSB0
	@echo "MyIp: " $(IP)
	@echo "Basestation IP: " $(BS)

debug_wtBS:
	 
	
	
	@echo "\nðŸ¤–ï¸âš½ï¸ Robot4 - Portugal Open 2023 ðŸ…ï¸ \n"
	@echo "ðŸ”›ï¸ðŸ“²ï¸ Permissions to Serial Ports..."
	@if echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB0; then\
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB0 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB0;\
		echo "ðŸ”›ï¸ðŸ—ï¸  Building program...";\
		go run . ttyUSB0 0 $(ID) $(IP) $(BS);\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
		#./player ttyUSB0 1 $(ID) $(IP) $(BS);\
	else echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB1; \
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB1 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB1;\
		echo "ðŸ”›ï¸ðŸ—ï¸  Building program...";\
		go run . ttyUSB1 0 $(ID) $(IP) $(BS);\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
		#./player ttyUSB1 1 $(ID) $(IP) $(BS);\
	fi
	
	
build:
	
	
	@echo "\nðŸ¤–ï¸âš½ï¸ Robot4 - Portugal Open 2023 ðŸ…ï¸ \n"
	@echo "ðŸ”›ï¸ðŸ“²ï¸ Permissions to Serial Ports..."
	@if echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB0; then\
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB0 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB0;\
		echo "ðŸ”›ï¸ðŸ—ï¸  Building program...";\
		go build .;\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
		#./player ttyUSB0 1 $(ID) $(IP) $(BS);\
	else echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB1; \
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB1 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB1;\
		echo "ðŸ”›ï¸ðŸ—ï¸  Building program...";\
		go build .;\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
		#./player ttyUSB1 1 $(ID) $(IP) $(BS);\
	fi

run:
	@echo "\nðŸ¤–ï¸âš½ï¸ Robot4 - Portugal Open 2023 ðŸ…ï¸ \n"
	@echo "ðŸ”›ï¸ðŸ“²ï¸ Permissions to Serial Ports..."
	@if echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB0; then\
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB0 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB0;\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
		./player ttyUSB0 1 $(ID) $(IP) $(BS);\
	else echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB1; \
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB1 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB1;\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
		./player ttyUSB1 1 $(ID) $(IP) $(BS);\
	fi
	
debug:
	
	
	@echo "\nðŸ¤–ï¸âš½ï¸ Robot4 - Portugal Open 2023 ðŸ…ï¸ \n"
	@echo "ðŸ”›ï¸ðŸ“²ï¸ Permissions to Serial Ports..."
	@if echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB0; then\
		echo "lar\n";\
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB0 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB0;\
		echo "ðŸ”›ï¸ðŸ—ï¸  Opening Server Yolo";\
		cd python && python3 Server.py &;\
		echo "ðŸ”›ï¸ðŸ—ï¸  Building program...";\
		go run . ttyUSB0 1 $(ID) $(IP) $(BS);\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
	else echo "lar\n"  @| sudo -S chmod 777 /dev/ttyUSB1; \
		echo "\nâœ…ï¸ðŸ“²ï¸ Serial Port ttyUSB1 ready!";\
		echo 0,0,0,0,0,0 > /dev/ttyUSB1;\
		echo "ðŸ”›ï¸ðŸ—ï¸  Building program...";\
		go run . ttyUSB1 1 $(ID) $(IP) $(BS);\
		echo "âœ…ï¸ðŸ’»ï¸ Program starting...";\
	fi
	
gen_grpc:
	@if python3 -m grpc_tools.protoc -I. --python_out=python --grpc_python_out=python message.proto; then echo "âœ…ï¸ðŸ”—ï¸ gRPC Generated to Python..."; else echo "âŒï¸ðŸ”—ï¸ gRPC not Generated to Python..."; fi
	
	@if go generate; then echo "âœ…ï¸ðŸ”—ï¸ gRPC Generated to Go..."; else echo "âŒï¸ðŸ”—ï¸ gRPC not Generated to Go..."; fi


test_kinect:
	freenect-glview

stop:
	echo 0,0,0,0,0,0 > /dev/ttyUSB0
	#echo 0,0,0,0,0,0 > /dev/ttyUSB1
